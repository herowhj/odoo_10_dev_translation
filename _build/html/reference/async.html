<!doctype html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
    <title>异步操作 &mdash; odoo 10.0 documentation</title>
    
    <link rel="stylesheet" href="../_static/style.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/patchqueue.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '10.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/patchqueue.js"></script>
    <script type="text/javascript" src="../_static/jquery.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap.js"></script>
    <script type="text/javascript" src="../_static/doc.js"></script>
    <script type="text/javascript" src="../_static/jquery.noconflict.js"></script>
    <link rel="top" title="odoo 10.0 documentation" href="../index.html" /> 
  </head>
  <body role="document"><header class="o_main_header o_has_sub_nav o_inverted ">
    <div class="o_main_header_main">
      <a class="pull-left o_logo" href="/"></a>
      <a href="#" class="o_mobile_menu_toggle visible-xs-block pull-right">
        <span class="sr-only">Toggle navigation</span>
        <span class="mdi-navigation-menu"></span>
      </a>
      <div class="o_header_buttons">
        <a href="http://www.odoo.com/trial" class="btn btn-primary">Start Now</a>
      </div>
      <ul class="o_primary_nav">
        <li class="dropdown">
          <a href="#" class="dropdown-toggle">Apps</a>
          <div class="dropdown-menu o_secondary_nav">
            <div class="container">
              <div class="row">
                <div class="col-sm-3 o_website_apps">
                  <div class="o_nav_app_family">
                    <span></span> Websites
                    <div>Build great user experience</div>
                  </div>
                  <ul>
                    <li><a href="https://www.odoo.com/page/website-builder">Website Builder</a></li>
                    <li><a href="https://www.odoo.com/page/e-commerce">eCommerce</a></li>
                    <li><a href="https://www.odoo.com/page/blog-engine">Blogs</a></li>
                    <li><a href="https://www.odoo.com/page/community-builder">Forums</a></li>
                    <li><a href="https://www.odoo.com/page/slides">Slides</a></li>
                    <li><a href="https://adspike.odoo.com">SEA</a></li>
                  </ul>
                </div>
                <div class="col-sm-3 o_sale_apps">
                  <div class="o_nav_app_family">
                    <span></span> Sales
                    <div>Boost your success rate</div>
                  </div>
                  <ul>
                    <li><a href="https://www.odoo.com/page/sales">Sales</a></li>
                    <li><a href="https://www.odoo.com/page/crm">CRM</a></li>
                    <li><a href="https://www.odoo.com/page/billing">Invoicing</a></li>
                    <li class="dropdown">
                      <a href="#0" class="dropdown-toggle">Point of Sale</a>
                      <ul>
                        <li><a href="https://www.odoo.com/page/point-of-sale">Shops</a></li>
                        <li><a href="https://www.odoo.com/page/pos-restaurant">Restaurants</a></li>
                      </ul>
                    </li>
                    <li><a href="https://www.odoo.com/page/subscriptions">Subscriptions</a></li>
                    <li><a href="https://www.odoo.com/page/sign">Sign</a></li>
                  </ul>
                </div>
                <div class="col-sm-3 o_operation_apps">
                  <div class="o_nav_app_family">
                    <span></span> Operations
                    <div>It's all about efficiency</div>
                  </div>
                  <ul>
                    <li><a href="https://www.odoo.com/page/accounting/">Accounting</a></li>
                    <li><a href="https://www.odoo.com/page/project-management/">Project</a></li>
                    <li class="dropdown">
                      <a href="#0" class="dropdown-toggle">Human Resources</a>
                      <ul>
                        <li><a href="https://www.odoo.com/page/recruitment">Recruitment</a></li>
                        <li><a href="https://www.odoo.com/page/employees">Employees</a></li>
                        <li><a href="https://www.odoo.com/page/expenses">Expenses</a></li>
                        <li><a href="https://www.odoo.com/page/appraisal">Appraisal</a></li>
                        <li><a href="https://www.odoo.com/page/fleet">Fleet</a></li>
                        <li><a href="https://www.odoo.com/page/leaves">Leaves</a></li>
                      </ul>
                    </li>
                    <li><a href="https://www.odoo.com/page/warehouse">Inventory</a></li>
                    <li><a href="https://www.odoo.com/page/purchase">Purchase</a></li>
                    <li class="dropdown">
                      <a href="#0" class="dropdown-toggle">Manufacturing</a>
                      <ul>
                        <li><a href="https://www.odoo.com/page/manufacturing">MRP</a></li>
                        <li><a href="https://www.odoo.com/page/plm">PLM</a></li>
                        <li><a href="https://www.odoo.com/page/maintenance">Maintenance</a></li>
                        <li><a href="https://www.odoo.com/page/quality">Quality</a></li>
                      </ul>
                    </li>
                  </ul>
                </div>
                <div class="col-sm-3 o_productivity_apps">
                  <div class="o_nav_app_family">
                    <span></span> Productivity Tools
                    <div>Great Tools = Happy People</div>
                  </div>
                  <ul>
                    <li class="dropdown">
                      <a href="#0" class="dropdown-toggle">Communication</a>
                      <ul>
                        <li><a href="https://www.odoo.com/page/discuss">Discuss</a></li>
                        <li><a href="https://www.odoo.com/page/discuss-groups">Mailing Lists</a></li>
                        <li><a href="https://www.odoo.com/page/notes">Notes</a></li>
                        <li><a href="#">Help desk</a></li>
                        <li><a href="#">Appointment</a></li>
                      </ul>
                    </li>
                    <li><a href="https://www.odoo.com/page/timesheet">Timesheet</a></li>
                    <li><a href="https://www.odoo.com/page/email-marketing">Email Marketing</a></li>
                    <li><a href="https://www.odoo.com/page/events">Events</a></li>
                    <li><a href="https://www.odoo.com/page/survey">Survey</a></li>
                    <li><a href="https://www.odoo.com/page/live-chat">Live Chat</a></li>
                  </ul>
                </div>
              </div>
            </div>
            <a href="http://www.odoo.com/apps/modules" class="o_store_link"><i class="fa fa-cube fa-fw"></i> Third party apps</a>
          </div>
        </li>
        <li><a href="https://www.odoo.com/page/tour">Tour</a></li>
        <li><a href="https://www.odoo.com/pricing">Pricing</a></li>
        <li><a href="https://www.odoo.com/page/docs">Docs</a></li>
      </ul>
    </div>
    <nav class="navbar o_sub_nav">
      <div class="container">
        <div class="navbar-header visible-xs">
            <button type="button" class="navbar-toggle collapsed text-left btn-block" data-toggle="collapse" data-target="#o_sub-menu" aria-expanded="false">
              Navigate
              <span class="mdi-hardware-keyboard-arrow-down pull-right"></span>
            </button>
        </div>

        <div class="collapse navbar-collapse" id="o_sub-menu">
          <ol class="o_breadcrumb breadcrumb nav navbar-left">
              
              





    
    <li class="active"><a href="#">异步操作</a></li>

              
          </ol>

          <div class="call-to-action navbar-right hidden-xs">
            <a href="http://www.odoo.com/trial" class="btn btn-primary">Start Now</a>
          </div>

          <ul class="navbar-nav navbar-right nav o_sub_nav_actions">
            
              <li class="divider"></li>
            

            
            


            
          </ul>

          <ul class="nav navbar-nav navbar-right">
            

            
            

<li><a href="http://www.odoo.com/documentation/user/10.0/index.html">User</a></li>
<li><a href="http://www.odoo.com/documentation/10.0/index.html">Developer</a></li>
<li><a href="http://www.odoo.com/documentation/10.0/api_integration.html">API</a></li>
<li><a href="http://www.odoo.com/documentation/10.0/setup/install.html">Installation</a></li>
<li><a href="http://www.odoo.com/page/odoo-white-paper">White Papers</a></li>
<li><a href="http://www.odoo.com/page/legal">Legal</a></li>
            

            
          </ul>
        </div>
      </div>
    </nav>
  </header><div id="wrap" class="">
    
    
    
    <figure class="card top has_banner">
      <span class="card-img" style="background-image: url('../_static/banners/installing_odoo.jpg');"></span>
      <div class="container text-center">
        <h1> 异步操作 </h1>
      </div>
    </figure>
    
    
    
    <div class="container ">
      <main class="container-fluid ">
        
        <div class="row">
          
          <aside>
            <div class="navbar-aside text-center">
              <ul class="list-group text-left nav"><li class="list-group-item"><a href="#deferreds" class="ripple internal reference">延迟模块(Deferreds)</a><ul ><li class="list-group-item"><a href="#id2" class="ripple internal reference">使用延迟模块(Deferreds)</a></li><li class="list-group-item"><a href="#id3" class="ripple internal reference">构建延迟模块(Deferreds)</a></li><li class="list-group-item"><a href="#reference-async-composition" class="ripple internal reference">组合延迟模块(Deferreds)</a><ul ><li class="list-group-item"><a href="#id6" class="ripple internal reference">延迟对象的多路传输</a></li><li class="list-group-item"><a href="#deferred-chaining" class="ripple internal reference">延迟链(Deferred chaining)</a></li></ul></li><li class="list-group-item"><a href="#jquery-deferred-api" class="ripple internal reference">jQuery.Deferred API</a></li></ul></li></ul>
              
              <p class="gith-container"><a href="https://github.com/odoo/odoo/edit/10.0/doc/reference/async.rst" class="gith-link">
                  Edit on GitHub
              </a></p>
              
            </div>
          </aside>
          
          <article class="doc-body ">
            
            
  <section id="reference-async"><i id="id1"></i><p >作为一门编程语言(和运行库), javascript在本质上是单线程的.
这意味着任何阻塞请求或者运算会阻塞整个页面(并且, 在老版本的浏览器中,
软件自身甚至会阻止用户切换至另一个标签页): 一个javascript环境可以被当成一个基于事件
的运行循环,在这个循环中应用的开发者无法控制循环本身.</p><p >因此, 不建议执行长时间运行的同步网络请求或者其他种类的复杂且开销巨大的访问,
取而代之的是异步API的应用.</p><p >这个指南的目标是提供一些处理异步系统的工具, 并且对系统问题和危害进行堤防.</p></section><section id="deferreds"><h2 >延迟模块(Deferreds)</h2><p >延迟模块(Deferreds)是一种形式的约定 (<a href="http://en.wikipedia.org/wiki/Promise_(programming)" class="external reference">promises</a>.) OpenERP Web 目前使用的是 <a href="http://api.jquery.com/category/deferred-object/" class="external reference">jQuery's deferred</a>.</p><p >延迟模块(Deferreds)的核心思想是这样的: 潜在的异步方法会返回一个 <a href="#Deferred" class="internal reference" title="Deferred"><code class="js-class xref js">Deferred()</code></a> 对象
而不是一个任意值或者(更常见的)什么也不返回.</p><p >这个对象可通过增加回调(callbacks)从而被用于跟踪异步操作的结束,
不论是成功的回调(callbacks)还是错误的回调(callbacks).</p><p >延迟模块(Deferreds)相对于直接简单的传递回调函数给异步方法的一个巨大优势是提供了一种能力:组合( <a href="#reference-async-composition" class="internal reference"><span class="std std-ref">compose them</span></a> ).</p></section><section id="id2"><h3 >使用延迟模块(Deferreds)</h3><p >延迟模块(Deferreds)最重要的方法是 <a href="#Deferred.then" class="internal reference" title="Deferred.then"><code class="js-func xref js">Deferred.then()</code></a>.
它被用于附加新的回调(callbacks)到延迟对象.</p><ul ><li >第一个参数附加了一个成功的回调, 在延迟对象被成功解析时调用并提供解析的值给异步操作.</li><li >第二个参数附加了一个失败的回调，在延迟对象被拒绝时调用并提供了拒绝的值(通常是一些错误消息).</li></ul><p >附加至延迟模块(Deferreds)的回调(callbacks)绝对不会是&quot;丢失(lost)&quot;:
如果一个回调被附加至一个已经解析或者拒绝的延迟, 这个回调会被立刻调用(或忽略).
一个延迟模块只会被解析或者拒绝一次, 其结果只会是已解析或已拒绝:
一个给定的延迟模块不可能调用一个单独的成功回调两次, 或者同时调用成功或者失败的回调(callbacks).</p><p ><a href="#Deferred.then" class="internal reference" title="Deferred.then"><code class="js-func xref js">then()</code></a> 会是你在与延迟对象(和异步API)交互时最常使用的方法.</p></section><section id="id3"><h3 >构建延迟模块(Deferreds)</h3><p >在使用了异步API后, 紧接着就要构建它们: 用于虚拟(<a href="http://en.wikipedia.org/wiki/Mock_object" class="external reference">mocks</a>),
用一个复杂的方式从多种源组成延迟模块(Deferreds),
从而使当前的操作刷新当前屏幕或者给其他事件展现的时间, ...</p><p >这在使用jQuery的延迟对象时是很容易实现的.</p><p >延迟模块(Deferreds)通过不使用任何参数调用它们的构造函数(constructor)创建出来 <a href="#id8" class="footnote-ref" id="id4">1</a> .
这样就用如下的方法创建了一个 <a href="#Deferred" class="internal reference" title="Deferred"><code class="js-class xref js">Deferred()</code></a> 实例对象:</p><p ><a href="#Deferred.resolve" class="internal reference" title="Deferred.resolve"><code class="js-func xref js">Deferred.resolve()</code></a></p><blockquote >就像他的名字指出的, 这个方法把延迟对象转换至&quot;已解析&quot;的状态.
可以提供必要数目的参数给它, 这些参数会被提供给任何处于等待状态的成功回调.</blockquote><p ><a href="#Deferred.reject" class="internal reference" title="Deferred.reject"><code class="js-func xref js">Deferred.reject()</code></a></p><blockquote >类似于 <a href="#Deferred.resolve" class="internal reference" title="Deferred.resolve"><code class="js-func xref js">resolve()</code></a>, 但是它是把延迟对象转换至&quot;已拒绝&quot;的状态
并且调用处于等待状态的失败处理函数.</blockquote><p ><a href="#Deferred.promise" class="internal reference" title="Deferred.promise"><code class="js-func xref js">Deferred.promise()</code></a></p><blockquote >创建一个延迟对象的只读视图. 一般来说, 返回一个延迟的约定视图来阻止调用器来解析或
拒绝这个对你有用的延迟对象.</blockquote><p ><a href="#Deferred.reject" class="internal reference" title="Deferred.reject"><code class="js-func xref js">reject()</code></a> 和 <a href="#Deferred.resolve" class="internal reference" title="Deferred.resolve"><code class="js-func xref js">resolve()</code></a> 被用于通知调用器
异步操作已经失效了 (或者成功了). 在异步操作已经结束了的时候应该简单的调用这些方法,
来通知任何对这个结果有兴趣的人.</p></section><section id="reference-async-composition"><i id="id5"></i><h3 >组合延迟模块(Deferreds)</h3><p >目前我们看到的东西都很好, 但大部分通过给其他函数来传递函数都是可以实现的
(即使增加函数实现起来可能比较繁琐... 但依然是可实现的).</p><p >延迟模块(Deferreds) 最大的亮点是当代码需要以某种方式来组合异步操作时,
因为他们可以被用于作为这样组合的一个基础.</p><p >延迟对象的组合方式主要有两种: 多路传输(multiplexing)和管线/级联(piping/cascading).</p></section><section id="id6"><h4 >延迟对象的多路传输</h4><p >多路传输的最常见的原因就是简单的执行多个异步操作
并且想要他们都完成之后才继续执行后续操作(并且处理更多事情).</p><p >jQuery的约定(promises)的多路传输函数是 <a href="#when" class="internal reference" title="when"><code class="js-func xref js">when()</code></a>.</p><div role="alert" class="alert-info alert"><p class="alert-title">Note</p><p >jQuery的 <a href="#when" class="internal alert-link reference" title="when"><code class="js-func xref js">when()</code></a> 的多路传输的表现是一个
(大部分情况下不相容的)定义于 <a href="http://wiki.commonjs.org/wiki/Promises/B" class="external reference alert-link">CommonJS Promises/B</a> 的扩展.</p></div><p >这个函数可以接收任何数目的约定 <a href="#id9" class="footnote-ref" id="id7">2</a> 并且会返回一个约定.</p><p >这个返回的约定在 <em >所有的</em> 多路传输约定已经被解析完毕之后被解析,
并且会在任何一个多路传输的约定被拒绝之后被立即拒绝
(用约定对象来代替布尔值, 它的表现就像Python语言里的 <code >all()</code> 函数).</p><p >如果需要的话, 多个通过 <a href="#when" class="internal reference" title="when"><code class="js-func xref js">when()</code></a> 多路传输的约定的解析值被分配到 <a href="#when" class="internal reference" title="when"><code class="js-func xref js">when()</code></a>
的成功回调函数参数里. 在约定位于函数  <a href="#when" class="internal reference" title="when"><code class="js-func xref js">when()</code></a> 里时,
约定的解析值与回调的参数有相同的索引, 因此你会获得:</p><div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">$</span><span class="p">.</span><span class="nx">when</span><span class="p">(</span><span class="nx">p0</span><span class="p">,</span> <span class="nx">p1</span><span class="p">,</span> <span class="nx">p2</span><span class="p">,</span> <span class="nx">p3</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span>
        <span class="kd">function</span> <span class="p">(</span><span class="nx">results0</span><span class="p">,</span> <span class="nx">results1</span><span class="p">,</span> <span class="nx">results2</span><span class="p">,</span> <span class="nx">results3</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// code</span>
<span class="p">});</span>
</pre></div>
</div>
</section><section id="deferred-chaining"><h4 >延迟链(Deferred chaining)</h4><p >第二个有用的组合是这样的, 把一个异步操作的结果作为另一异步操作的开始, 并且需要二者的结果:
使用目前已经描述过的工具, 就拿处理 OpenERP 的查找/读取队列来说,
需要如下的这样几行:</p><div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">Deferred</span><span class="p">();</span>
<span class="nx">Model</span><span class="p">.</span><span class="nx">search</span><span class="p">(</span><span class="nx">condition</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">ids</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">Model</span><span class="p">.</span><span class="nx">read</span><span class="p">(</span><span class="nx">ids</span><span class="p">,</span> <span class="nx">fields</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">records</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">result</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">records</span><span class="p">);</span>
    <span class="p">});</span>
<span class="p">});</span>
<span class="k">return</span> <span class="nx">result</span><span class="p">.</span><span class="nx">promise</span><span class="p">();</span>
</pre></div>
</div>
<p >这个代码片段看起来还是不错的, 不过马上它就会变得很笨重.</p><p >但是 <a href="#Deferred.then" class="internal reference" title="Deferred.then"><code class="js-func xref js">then()</code></a> 也会允许处理这类的链路:
它返回一个新的约定对象, 而不是它调用的那个, 并且返回回调(callbacks)的值,
这个行为来说很重要: 不论是调用了哪个回调函数.</p><ul ><li >如果没有设置回调(没有提供或者留空), 那解析或者拒绝值就会简单的递交给
<a href="#Deferred.then" class="internal reference" title="Deferred.then"><code class="js-func xref js">then()</code></a> 的约定(它本质上是个空操作)</li><li ><p >如果设置了回调并且不返回一个可观测的对象( 一个延迟或者一个约定),
那么它的返回值 (如果不返回任何东西的话就为 <code >未定义(undefined)</code> ) 会代替给它的值.</p><div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">promise</span><span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;called&#39;</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>
</div>
<p >会用这个单独值 <code >未定义(undefined)</code> 来解析.</p></li><li ><p >如果设置了回调并返回了一个可观测的对象, 那么这个对象会成为这个管线的真实解析(和结果).
这意味着一个来自失败回调的已经解析的约定会解析这个管线,
并且一个来自成功回调的失败的约定会拒绝这个管线.</p><p >这提供了一个简易的链路操作继承, 并且之前的代码片段可以被重写:</p><div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="k">return</span> <span class="nx">Model</span><span class="p">.</span><span class="nx">search</span><span class="p">(</span><span class="nx">condition</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">ids</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">Model</span><span class="p">.</span><span class="nx">read</span><span class="p">(</span><span class="nx">ids</span><span class="p">,</span> <span class="nx">fields</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>
</div>
<p >如果 <code >search</code> 或者 <code >read</code> 失败, 整个表达的结果会编码失败(有正确的拒绝值),
并且链路处理正确的话, 会被 <code >read</code> 的解析结果来解析.</p></li></ul><p >在使用第三方的基于约定的API时, <a href="#Deferred.then" class="internal reference" title="Deferred.then"><code class="js-func xref js">then()</code></a> 同样是有用的,
用于过滤示例的解析值计数 (为了使用 <a href="#when" class="internal reference" title="when"><code class="js-func xref js">when()</code></a> 的对于单值约定的特殊的处理).</p></section><section id="jquery-deferred-api"><h3 >jQuery.Deferred API</h3><section class="code-function"><h6 id="when"><code>when(<em>deferreds…</em>)</code></h6><div class="code-fields"><div class="code-field"><div class="code-field-name">Arguments</div><div class="code-field-body"><ul ><li ><strong >deferreds</strong> -- 多路传输的延迟对象</li></ul></div></div><div class="code-field"><div class="code-field-name">Returns</div><div class="code-field-body">被多路传输的延迟对象</div></div><div class="code-field"><div class="code-field-name">Return type</div><div class="code-field-body"><a href="#Deferred" class="internal alert-link reference" title="Deferred"><code class="js-class xref js">Deferred()</code></a></div></div></div></section><section class="code-class"><h6 id="Deferred"><code><em >class </em>Deferred()</code></h6><section class="code-function"><h6 id="Deferred.then"><code>Deferred.then(<em>doneCallback</em>[, <em>failCallback</em>])</code></h6><p >附加新的回调(callbacks)至解析或者拒绝的延迟对象.
回调(callbacks) 以他们被附加至延迟的顺序被处理.</p><p >为了只提供一个失败回调, 传递 <code >空(null)</code> 来作为 <code >完成回调(doneCallback)</code>,
为了只提供一个成功回调, 第二个参数可以被忽略(并且不传递).</p><p >返回一个新的延迟, 其解析相应回调的结果, 如果回调返回一个延迟本身,
那么新的回调会被用于链路的解析.</p><div class="code-fields"><div class="code-field"><div class="code-field-name">Arguments</div><div class="code-field-body"><ul ><li ><strong >doneCallback</strong> -- 延迟解析完成调用的函数</li><li ><strong >failCallback</strong> -- 延迟拒绝之后调用的函数</li></ul></div></div><div class="code-field"><div class="code-field-name">Returns</div><div class="code-field-body">调用它的延迟对象</div></div><div class="code-field"><div class="code-field-name">Return type</div><div class="code-field-body"><a href="#Deferred" class="internal alert-link reference" title="Deferred"><code class="js-class xref js">Deferred()</code></a></div></div></div></section><section class="code-function"><h6 id="Deferred.done"><code>Deferred.done(<em>doneCallback</em>)</code></h6><p >附加一个新的成功回调至延迟对象, <code >deferred.then(doneCallback)</code> 的快捷方式.</p><p >这是一个 <a href="http://wiki.commonjs.org/wiki/Promises/A" class="external reference alert-link">CommonJS Promises/A</a> 的jQuery扩展, 提供了很少的值来直接调用
<a href="#Deferred.then" class="internal alert-link reference" title="Deferred.then"><code class="js-func xref js">then()</code></a> , 这应该被避免.</p><div class="code-fields"><div class="code-field"><div class="code-field-name">Arguments</div><div class="code-field-body"><ul ><li ><strong >doneCallback</strong> (<code >Function</code>) -- 延迟被解析后调用的函数</li></ul></div></div><div class="code-field"><div class="code-field-name">Returns</div><div class="code-field-body">调用它的延迟对象</div></div><div class="code-field"><div class="code-field-name">Return type</div><div class="code-field-body"><a href="#Deferred" class="internal alert-link reference" title="Deferred"><code class="js-class xref js">Deferred()</code></a></div></div></div></section><section class="code-function"><h6 id="Deferred.fail"><code>Deferred.fail(<em>failCallback</em>)</code></h6><p >附加一个新的失败回调至延迟对象, <code >deferred.then(null, failCallback)</code> 的快捷方式.</p><p ><a href="CommonJSPromises/A" class="external reference alert-link">Promises/A</a> 的第二个jQuery扩展.
尽管它比 <a href="#Deferred.done" class="internal alert-link reference" title="Deferred.done"><code class="js-func xref js">done()</code></a> 提供了更多的值, 它仍然不够且应该被避免.</p><div class="code-fields"><div class="code-field"><div class="code-field-name">Arguments</div><div class="code-field-body"><ul ><li ><strong >failCallback</strong> (<code >Function</code>) -- 延迟被拒绝时调用的函数</li></ul></div></div><div class="code-field"><div class="code-field-name">Returns</div><div class="code-field-body">调用它的延迟对象</div></div><div class="code-field"><div class="code-field-name">Return type</div><div class="code-field-body"><a href="#Deferred" class="internal alert-link reference" title="Deferred"><code class="js-class xref js">Deferred()</code></a></div></div></div></section><section class="code-function"><h6 id="Deferred.promise"><code>Deferred.promise()</code></h6><p >返回一个延迟对象的只读视图, 移除了所有的设值方法(解析或者拒绝).</p></section><section class="code-function"><h6 id="Deferred.resolve"><code>Deferred.resolve(<em>value…</em>)</code></h6><p >被调用来解析一个延迟, 任何提供的值会被传递给延迟对象的成功处理函数.</p><p >解析一个已经被解析或者拒绝的延迟没有任何效果.</p></section><section class="code-function"><h6 id="Deferred.reject"><code>Deferred.reject(<em>value…</em>)</code></h6><p >被调用来拒绝(失败)一个延迟, 任何提供的值会被传递给延迟对象的失败处理函数.</p><p >拒绝一个已经被解析或者拒绝的延迟没有任何效果.</p></section></section><div class="footnote" id="id8"><span class="footnote-label"><a class="footnote-backref" href="#id4">[1]</a></span> 或者只是调用 <a href="#Deferred" class="internal reference" title="Deferred"><code class="js-class xref js">Deferred()</code></a> 作为一个函数, 结果是一样的.</div><div class="footnote" id="id9"><span class="footnote-label"><a class="footnote-backref" href="#id7">[2]</a></span> <p >或者非约定(not-promises), <a href="http://wiki.commonjs.org/wiki/Promises/B" class="external reference">CommonJS Promises/B</a> 的 <a href="#when" class="internal reference" title="when"><code class="js-func xref js">when()</code></a>
是一个可以一致的处理数值和约定的角色: <a href="#when" class="internal reference" title="when"><code class="js-func xref js">when()</code></a> 会直接传递约定,
但是非约定的值和对象会被转换成一个已解析的约定 (用它们自己的值来解析它们).</p><p >jQuery的 <a href="#when" class="internal reference" title="when"><code class="js-func xref js">when()</code></a> 保持这个特性, 使得延迟模块(Deferreds)
更容易由&quot;静态(static)&quot; 值创建, 或者在约定被打包进 <a href="#when" class="internal reference" title="when"><code class="js-func xref js">when()</code></a> 时
来允许防御性代码, 以防万一.</p></div></section>

          </article>
        </div>
        
        <div id="mask"></div>
      </main>
    </div>
  </div>

  <div class="floating_action_container">
    <a id="floating_action" class="ripple" href="#">
      <i class="mdi-action-explore"></i>
    </a>
    <div id="floating_action_menu">
      <span class="bubble"></span>
      <ul class="list-group content">
        <li class="list-group-item ripple"><a>Cras justo odio</a></li>
        <li class="list-group-item ripple"><a>Dapibus ac facilisis in</a></li>
        <li class="list-group-item ripple"><a>Morbi leo risus</a></li>
        <li class="list-group-item ripple"><a>Porta ac consectetur ac</a></li>
        <li class="list-group-item ripple"><a>Vestibulum at eros</a></li>
      </ul>
    </div>
  </div>
  <footer>
    <div id="footer" class="container">
      <span class="o_logo o_logo_inverse center-block o_footer_logo"></span>
      <div class="row">
        <div class="col-sm-7 col-md-7 col-lg-6">
          <div class="row">
            <div class="col-xs-6 col-sm-4">
              <span class="menu_title">Community</span>
              <ul>
                <li><a href="https://github.com/odoo/odoo">Github</a></li>
                <li><a href="http://www.odoo.com/page/download">Download</a></li>
                <li class="divider"></li>
                <li><a href="http://runbot.odoo.com/runbot/repo/git-github-com-odoo-enterprise-7">Runbot</a></li>
                <li><a href="https://github.com/odoo/odoo/wiki/Translations">Translations</a></li>
                <li class="divider"></li>
                <li><a href="http://www.odoo.com/page/odoo-community">Mailing Lists</a></li>
                <li><a href="http://www.odoo.com/forum/help-1">Forum</a></li>
              </ul>
            </div>
            <div class="col-xs-6 col-sm-4">
              <span class="menu_title">Services</span>
              <ul>
                <li><a href="http://www.odoo.com/pricing">Editions</a></li>
                <li><a href="http://www.odoo.com/pricing-online">Cloud Pricing</a></li>
                <li><a href="http://www.odoo.com/page/upgrade">Upgrade</a></li>
                <li class="divider"></li>
                <li><a href="http://www.odoo.com/partners">Find a partner</a></li>
                <li><a href="http://www.odoo.com/page/become-a-partner">Become a partner</a></li>
                <li class="divider"></li>
                <li><a href="http://www.odoo.com/page/education-program">Education</a></li>
                <li class="divider"></li>
                <li><a href="http://www.odoo.com/page/security">Security</a></li>
              </ul>
            </div>
            <div class="col-sm-4 mb64">
              <span class="menu_title">About us</span>
              <ul>
                <li><a href="http://www.odoo.com/page/about-us">Our company</a></li>
                <li><a href="http://www.odoo.com/page/contactus">Contact</a></li>
                <li class="divider" />
                <li><a href="http://www.odoo.com/event">Events</a></li>
                <li><a href="http://www.odoo.com/blog/">Blog</a></li>
                <li><a href="http://www.odoo.com/blog/6">Customers</a></li>
                <li class="divider" />
                <li><a href="http://www.odoo.com/jobs">Jobs</a></li>
              </ul>
            </div>
          </div>
        </div>
        <div class="col-sm-5 col-md-4 col-md-offset-1 col-lg-5 col-lg-offset-1">
          <p>
            <small>
              Odoo is a suite of open source business apps that cover all your company needs: CRM, eCommerce, accounting, inventory, point of sale, project management, etc.
              <br/><br/>
              Odoo's unique value proposition is to be at the same time very easy to use and fully integrated.
            </small>
          </p>
        </div>
      </div>
    </div>
    <div class="o_footer_bottom">
      <div class="container">
        <a class="small" href="http://www.odoo.com/page/website-builder">Website made with <span class="o_logo o_logo_inverse o_logo_15"></span></a>
        <div class="social-links pull-right">
          <a href="http://www.odoo.com/web/about/facebook"><i class="fa fa-facebook"></i></a>
          <a href="http://www.odoo.com/web/about/twitter"><i class="fa fa-twitter"></i></a>
          <a href="http://www.odoo.com/web/about/linkedin"><i class="fa fa-linkedin"></i></a>
          <a href="mailto:info@odoo.com"><i class="fa fa-envelope"></i></a>
        </div>
      </div>
    </div>
  </footer>
  </body>
</html>